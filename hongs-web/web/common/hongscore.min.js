/**
 * HongsCORE4js
 * @author Hongs
 * @version 15.3.3
 */
if(typeof(HsAUTH)==="undefined"){HsAUTH={}}if(typeof(HsCONF)==="undefined"){HsCONF={}}if(typeof(HsLANG)==="undefined"){HsLANG={}}function H$(){var g=arguments[0];var f=g.charAt(0);arguments[0]=g.substring(1);switch(f){case".":return hsGetConf.apply(this,arguments);case":":return hsGetLang.apply(this,arguments);case"?":return hsChkUri.apply(this,arguments);case"/":return hsFixUri.apply(this,arguments);case"&":case"@":if(arguments.length===1){arguments[1]=location.href}if(typeof(arguments[1])!=="string"){if(!jQuery.isArray(arguments[1])){var l=jQuery(arguments[1]).closest(".loadbox");var k=hsSerialArr(l.data("url"));var j=hsSerialArr(l.data("data"));for(var h=0;h<j.length;h++){k.push(j[h])}arguments[1]=k}if(f==="@"){return hsGetSerias(arguments[1],arguments[0])}else{return hsGetSeria(arguments[1],arguments[0])}}else{if(f==="@"){return hsGetParams(arguments[1],arguments[0])}else{return hsGetParam(arguments[1],arguments[0])}}case"$":case"%":var l=f==="$"?window.sessionStorage:window.localStorage;if(typeof(l)==="undefined"){throw ("H$: Does not support '"+(f=="$"?"session":"local")+"Storage'")}if(arguments.length===1){return l.getItem(arguments[0])}else{if(arguments[1]){l.setItem(arguments[0],arguments[1])}else{l.removeItem(arguments[0])}}default:throw ("H$: Unrecognized identified '"+f+"'")}}function hsResponObj(rst,qut){if(typeof(rst.responseText)!=="undefined"){rst=rst.responseText}if(typeof(rst)==="string"){if(rst.charAt(0)==="{"){if(typeof(JSON)!=="undefined"){rst=JSON.parse(rst)}else{rst=eval("("+rst+")")}}else{if(rst.charAt(0)==="<"){rst={ok:false,err:"",msg:rst.replace(/<script.*?>.*?<\/script>/img,"").replace(/<style.*?>.*?<\/style>/img,"").replace(/<[^>]*?>/g,"").replace(/&[^&;]*;/g,"").replace(/^\s*(\r\n|\r|\n)/mg,"")}}else{rst={ok:false,err:"",msg:rst}}}}if(typeof(rst)==="object"){if(typeof(rst.ok)==="undefined"){rst.ok=true}if(typeof(rst.err)==="undefined"){rst.err=""}if(typeof(rst.msg)==="undefined"){rst.msg=""}if(!qut){if(rst.ok){if(rst.msg){jQuery.hsNote(rst.msg,"alert-success")}}else{if(rst.msg){alert(rst.msg)}else{alert(hsGetLang("error.unkwn"))}}}if(typeof(rst["goto"])!=="undefined"){if(rst["goto"]){location.assign(rst["goto"])}else{location.reload()}delete rst["goto"]}}return rst}function hsSerialArr(e){var b=[];if(typeof(e)==="string"){var c,a;c=e.split("#",2);if(c.length>1){e=c[0]}c=e.split("?",2);if(c.length>1){e=c[1]}c=e.split("&");for(var d=0;d<c.length;d++){a=c[d].split("=",2);if(a.length<2||!a[0]||!a[1]){break}b.push({name:decodeURIComponent(a[0]),value:decodeURIComponent(a[1])})}}else{if(jQuery.isPlainObject(e)){hsEach(e,function(g,f){if(f.length<1||g.length<1){return}b.push({name:f.join("."),value:g})})}else{if(!jQuery.isArray(e)&&typeof(e)==="object"){b=jQuery(e).serializeArray()}else{if(e!=null){b=e}}}}return b}function hsSerialObj(c){var a=hsSerialArr(c);c={};for(var b=0;b<a.length;b++){hsSetValue(c,a[b].name,a[b].value)}return c}function hsGetSerias(a,b){var d=[];for(var c=0;c<a.length;c++){if(a[c]["name"]===b){d.push(a[c]["value"])}}return d}function hsSetSerias(a,c,e){for(var b=a.length-1;b>-1;b--){if(a[b]["name"]===c){a.splice(b,1)}}for(var d=0;d<e.length;d++){a.push({name:c,value:e[d]})}}function hsGetSeria(a,b){var c=hsGetSerias(a,b);if(c.length){return c.pop()}else{return""}}function hsSetSeria(a,b,c){hsSetSerias(a,b,[c])}function hsGetParams(c,b){b=encodeURIComponent(b).replace(".","\\.");var d=new RegExp("[\\?&]"+b+"=([^&]*)","g");var a=null;var e=[];while(true){a=d.exec(c);if(a===null){break}e.push(decodeURIComponent(a[1]))}return e}function hsSetParams(b,a,e){a=encodeURIComponent(a).replace(".","\\.");var d=new RegExp("[\\?&]"+a+"=([^&]*)","g");b=b.replace(d,"");for(var c=0;c<e.length;c++){b+="&"+encodeURIComponent(a)+"="+encodeURIComponent(e[c])}if(b.indexOf("?")<0){b=b.replace("&","?")}return b}function hsGetParam(b,a){var c=hsGetParams(b,a);if(c.length){return c.pop()}else{return""}}function hsSetParam(b,a,c){return hsSetParams(b,a,[c])}function hsGetValue(d,c,b){if(jQuery.isArray(c)){return _hsGetPoint(d,c,b)}if(typeof(c)==="number"){return _hsGetPoint(d,[c],b)}if(typeof(c)!=="string"){throw ("hsGetValue: 'path' must be a string")}var a=_hsGetDakey(c);return _hsGetPoint(d,a,b)}function _hsGetPoint(c,a,b){if(!c){return b}if(!jQuery.isArray(c)&&!jQuery.isPlainObject(c)){throw ("_hsGetPoint: 'obj' must be an array or object")}if(!jQuery.isArray(a)){throw ("_hsGetPoint: 'keys' must be an array")}if(!a.length){throw ("_hsGetPoint: 'keys' can not be empty")}return _hsGetDepth(c,a,b,0)}function _hsGetDepth(d,b,c,e){var a=b[e];if(d==null){return c}if(a==null){if(b.length==e+1){return d}else{return _hsGetDapth(d,b,c,e+1)}}else{if(typeof(a)=="number"){if(d.length<=a){return c}if(b.length==e+1){return d[a]||c}else{return _hsGetDepth(d[a],b,c,e+1)}}else{if(b.length==e+1){return d[a]||c}else{return _hsGetDepth(d[a],b,c,e+1)}}}}function _hsGetDapth(a,d,e,g){var b=[];for(var c=0;c<a.length;c++){var f=_hsGetDepth(a[c],d,e,g);if(f!=null){b.push(f)}}if(!jQuery.isEmptyObject(b)){return b}else{return e}}function _hsGetDakey(d){d=d.replace(/\]\[/g,".").replace(/\[/,".").replace(/\]/,"").split(/\./);var b,c=[];for(b=0;b<d.length;b++){var a=d[b];if(a.length==0){c.push(null)}else{if(a.substr(0,1)=="#"){c.push(parseInt(a.substr(1)))}else{c.push(a)}}}return c}function hsSetValue(c,b,d){if(jQuery.isArray(b)){_hsSetPoint(c,b,d);return}if(typeof(b)==="number"){_hsSetPoint(c,[b],d);return}if(typeof(b)!=="string"){throw ("hsSetValue: 'path' must be a string")}var a=_hsGetDakey(b);_hsSetPoint(c,a,d)}function _hsSetPoint(b,a,c){if(!b){return}if(!jQuery.isPlainObject(b)){throw ("_hsSetPoint: 'obj' must be an object")}if(!jQuery.isArray(a)){throw ("_hsSetPoint: 'keys' must be an array")}if(!a.length){throw ("_hsSetPoint: 'keys' can not be empty")}_hsSetDepth(b,a,c,0)}function _hsSetDepth(d,c,e,f){var b=c[f];if(b==null){if(d==null){d=[]}if(c.length==f+1){d.push(e)}else{d.push(_hsSetDepth(null,c,e,f+1))}return d}else{if(typeof(b)=="number"){if(d==null){d=[]}if(d.length<=b){for(var a=0;a<=b;a++){d.push(null)}}if(c.length==f+1){d[b]=e}else{d[b]=_hsSetDepth(d[b],c,e,f+1)}return d}else{if(d==null){d={}}if(c.length==f+1){d[b]=e}else{d[b]=_hsSetDepth(d[b],c,e,f+1)}return d}}}function hsGetConf(a,b){if(typeof(HsCONF[a])!=="undefined"){return HsCONF[a]}else{return b}}function hsGetLang(c,d){if(typeof(HsLANG[c])!=="undefined"){c=HsLANG[c]}if(d instanceof Array){var b,a={};for(b in d){a[b+""]=d[b]}d=a}if(d instanceof Object){c=c.replace(/\$(\{\w+\}|\w+)/gm,function(e){if(e.substring(0,2)=="${"){e=e.substring(2,e.length-1)}else{e=e.substring(1)}if(typeof(d[e])!=="undefined"){return d[e]}else{return""}})}return c}function hsChkUri(a){return HsAUTH?HsAUTH[hsFixUri(a)]:false}function hsFixUri(a){if(/^(\w+:\/\/|\/|\.)/.test(a)===false){return hsGetConf("BASE_HREF")+"/"+a}else{return a}}function hsFmtNum(r,u,h,y,c){if(typeof(u)==="undefined"){u=0}if(typeof(h)==="undefined"){h=2}if(typeof(y)==="undefined"){y=","}if(typeof(c)==="undefined"){c="."}var f=hsParseInt(r);var e=Math.pow(10,h);r=(Math.round(f*e)/e).toString();var w=r.split(".",2);if(w.length<2){w[1]="0"}var g=w[0];var v=w[1];var b=g.length;for(var q=b;q<u;q++){g="0"+g}var t=v.length;for(var m=t;m<h;m++){v=v+"0"}r="";h="";if(y){var l,x="";while(g!=""){l=g.length-3;x=g.substring(l);g=g.substring(0,l);r=x+y+r}if(r){l=r.length-1;r=r.substring(0,l)}while(v!=""){x=v.substring(0,3);v=v.substring(3);h=h+y+x}if(h){h=h.substring(1)}}else{r=g;h=v}return r+c+h}function hsFmtDate(f,r){if(typeof(f)==="string"){if(/^\d+$/.test(f)){f=parseInt(f)}else{f=Date.parse(f.replace(/-/g,"/").replace(/\.\d+$/,""))}}if(typeof(f)==="number"){if(f<=2147483647){f=f*1000}f=new Date(f)}var o=f.getFullYear();var l=f.getMonth();var n=f.getDate();var t=f.getHours();var g=t+1;var p=t>11?t-12:t;var j=t>12?t-12:t;var e=f.getMinutes();var v=f.getSeconds();var i=f.getMilliseconds();var u=f.getDay();var q=t<12?0:1;if(p==12){p=0}if(j==0){j=12}function c(h,a){h=h?h:"";h=h.toString();var d=h.length;for(var k=d;k<a;k++){h="0"+h}return h}function b(k){var d=k.length;var h=k.substring(0,1);switch(h){case"y":var a=c(o,d);if(d<=2){return a.substring(a.length-d)}else{return a}case"M":if(d>=4){return hsGetLang("date.format.LM")[l]}else{if(d==3){return hsGetLang("date.format.SM")[l]}else{return c(l+1,d)}}case"d":return c(n,d);case"H":return c(t,d);case"k":return c(g,d);case"K":return c(p,d);case"h":return c(j,d);case"m":return c(e,d);case"s":return c(v,d);case"S":return c(i,d);case"E":if(d>=4){return hsGetLang("date.format.LE")[u]}else{return hsGetLang("date.format.SE")[u]}case"a":if(d>=4){return hsGetLang("date.format.La")[q]}else{return hsGetLang("date.format.Sa")[q]}}}return r.replace(/M+|d+|y+|H+|k+|K+|h+|m+|s+|S+|E+|a+/g,b)}function hsPrsDate(w,t){if(typeof(w)==="string"){if(/^\d+$/.test(w)){w=parseInt(w)}}if(typeof(w)==="number"){if(w<=2147483647){w=w*1000}return new Date(w)}var r=w.split(/\W+/);var q=t.match(/M+|d+|y+|H+|k+|K+|h+|m+|s+|S+|E+|a+/g);var k,h;var n,o,p,v=0,g=0,x=0,f=0;for(k=0;k<q.length;k++){if(r[k]==null){continue}var u=r[k];var l=q[k].length;var e=q[k].substring(0,1);switch(e){case"M":if(l>=4){for(h=0;h<hsGetLang("date.format.LM").length;h++){if(u==hsGetLang("date.format.LM")[h]){n=h;break}}}else{if(l==3){for(h=0;h<hsGetLang("date.format.SM").length;h++){if(u==hsGetLang("date.format.SM")[h]){n=h;break}}}else{n=parseInt(u,10)}}break;case"d":o=parseInt(u,10);break;case"y":p=parseInt(u,10);if(l<=2){p+=p>29?1900:2000}break;case"H":case"K":v=parseInt(u,10);break;case"k":case"h":v=parseInt(u,10)-1;break;case"m":g=parseInt(u,10);break;case"s":x=parseInt(u,10);break;case"a":if(l>=4){for(h=0;h<hsGetLang("date.format.La").length;h++){if(u==hsGetLang("date.format.La")[h]){f=h;break}}}else{for(h=0;h<hsGetLang("date.format.Sa").length;h++){if(u==hsGetLang("date.format.Sa")[h]){f=h;break}}}break}}if(f==1){v+=12}var c;if(typeof(n)!=="undefined"&&typeof(o)!=="undefined"&&typeof(p)!=="undefined"){c=n+"/"+o+"/"+p+" "+v+":"+g+":"+x}else{c=v+":"+g+":"+x}return new Date(Date.parse(c))}function hsEach(d,c){var e=[];if(arguments.length>2){e=arguments[2]}if(jQuery.isPlainObject(d)){for(var a in d){hsEach(d[a],c,e.concat([a]))}}else{if(jQuery.isArray(d)){for(var b=0;b<d.length;b++){hsEach(d[b],c,e.concat([b]))}}else{c(d,e)}}}function _hs2bsDF(a){return a.replace(/a/g,"P").replace(/m/g,"i").replace(/M/g,"m").replace(/H/g,"x").replace(/h/g,"H").replace(/x/g,"h")}function _bs2hsDF(a){return a.replace(/m/g,"M").replace(/i/g,"m").replace(/P/gi,"a").replace(/H/g,"x").replace(/h/g,"H").replace(/x/g,"h")}(function($){$.jqAjax=$.ajax;$.hsAjax=function(url,settings){if(typeof(url)==="object"){settings=url;if(typeof(url.url)!=="undefined"){url=url.url}}return $.jqAjax(hsFixUri(url),settings)};$.hsNote=function(msg,cls,sec){if(!cls){cls="alert-info"}if(!sec){sec=5}var div=$('<div class="alert alert-dismissable"><button type="button" class="close">&times;</button><div class="notebox"></div></div>').addClass(cls);var btn=div.find("button");var box=div.find(".notebox").append(msg);var ctr=$("#notebox").append(div).show();div.slideDown(200);btn.click(function(){div.slideUp(200,function(){div.remove();if(ctr.children().size()==0){ctr.hide()}})});setTimeout(function(){btn.click()},sec*1000);return box};$.hsOpen=function(url,data,complete){var div=$('<div class="modal"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">'+hsGetLang("opening")+'</h4></div><div class="modal-body openbox"></div></div></div></div>').css("z-index",99999);var box=div.find(".openbox");div.modal();box.hsLoad(url,data,complete);return box};$.fn.jqLoad=$.fn.load;$.fn.hsLoad=function(url,data,complete){if($.isFunction(data)){complete=data;data=undefined}if(!$.isFunction(complete)){complete=function(){}}this.data("url",url).data("data",data);this.addClass("loadbox").addClass("loading");return $.fn.jqLoad.call(this,hsFixUri(url),data,function(){var that=$(this);that.removeClass("loading");complete.apply(this,arguments);that.hsReady()})};$.fn.hsOpen=function(url,data,complete){var prt=$(this);var box;var pre;var tab;if(prt.is(".panes")){prt=prt.data("rel");prt=prt.hsTaba(url);tab=prt[0];prt=prt[1]}else{if(prt.is(".nav")){prt=prt.hsTaba(url);tab=prt[0];prt=prt[1]}else{if(prt.parent().is(".nav")){tab=prt;prt=tab.parent().data("rel").children().eq(tab.index())}else{if(prt.parent().is(".panes")){tab=prt.parent().data("rel").children().eq(prt.index())}}}}if(tab){pre=tab.parent().children().filter(".active");tab.show().find("a").click();if(tab.find("a span").size()){tab.find("a span").not(".close").text(hsGetLang("loading"))}else{tab.find("a").text(hsGetLang("loading"))}if(prt.children().size()){prt.children().hsCloze();prt.empty()}}else{pre=prt.contents().detach()}box=$('<div class="openbox"></div>').appendTo(prt).data("pre",pre);box.hsLoad(url,data,complete);return box};$.fn.hsClose=function(){var prt=$(this).parent();var box=$(this);var tab;if(prt.parent().is(".panes")){tab=prt.parent().data("rel").children().eq(prt.index())}else{if(prt.parent().is(".nav")){tab=prt;prt=tab.parent().data("rel").children().eq(tab.index());box=prt.children(".openbox")}}box.trigger("hsClose");box.hsCloze();if(tab){var idx=box.data("pre")?box.data("pre").index():0;tab.parent().children().eq(idx).find("a").click();if(tab.has(".close").size()){tab.remove();prt.remove()}}else{if(box.data("pre")){prt.append(box.data("pre"));box.remove()}else{if(box.closest(".modal").size()){box.closest(".modal").modal("hide").remove()}}}return box};$.fn.hsCloze=function(){var box=$(this);$(document.body).find(".openbox").each(function(){if(box.is($(this).data("rel"))){$(this).hsClose()}});return box};$.fn.hsReady=function(){var box=$(this);if(box.is(".tabsbox")){box.hsTabw().hsReady();return box}box.find("*").contents().filter(function(){return this.nodeType==3&&/^\s+$/.test(this.nodeValue)}).remove();box.find("input").each(function(){$(this).addClass("input-"+$(this).attr("type"))});if(box.children("object.config[name=hsInit]").size()===0){box.hsInit({})}box.find("object.config").each(function(){var prnt=$(this).parent();var func=$(this).attr("name");var opts=$(this)._hsConfig();if(typeof(prnt[func])==="function"){prnt[func](opts)}}).remove();box.find("[data-eval]").each(function(){eval($(this).attr("data-eval"))});box.find("[data-load]").each(function(){$(this).hsLoad($(this).attr("data-load"))});box.find("[data-open]").each(function(){$(this).hsOpen($(this).attr("data-open"))});box.find(".nav").each(function(){$(this).hsTabs()});box.find(".dropdown-body").each(function(){var x=$(this).parent().is(".dropup");$(this).toggleClass("invisible",!x)});box.trigger("hsReady");return box};$.fn.hsInit=function(cnf){var box=$(this);var h=box.children("h1,h2,h3");if(h.length){cnf.title=h.text()}if(cnf.title){cnf.title=H$("&id",box)?hsGetLang(cnf.title,{opr:cnf.update||hsGetLang("form.update")}):hsGetLang(cnf.title,{opr:cnf.create||hsGetLang("form.create")})}if(h.length){h.text(cnf.title)}if(box.parent().parent().is(".panes")){var a=box.parent();var b=box.parent().parent();a=b.data("rel").children().eq(a.index());for(var k in cnf){var v=cnf[k];switch(k){case"title":var x=a.find("a");var y=x.find("span").not(".close");if(y.size()){y.text(v)}else{x.text(v)}break}}}else{if(box.is(".modal-body")){var a=box.closest(".modal");for(var k in cnf){var v=cnf[k];switch(k){case"title":a.find(".modal-title").text(v);break;case"modal":a.find(".modal-dialog").addClass("modal-"+v);break}}a.modal()}}return box};$.fn.hsTabw=function(){var box=$(this);var tbs=$('<ul class="nav nav-tabs"><li><a href="javascript:;"></a></li></ul>');var pns=$('<div class="panes"></div>');var pan=$("<div></div>").appendTo(pns);var div=$("<div></div>").appendTo(pan);div.append(box.contents()).addClass("openbox");box.append(tbs);box.append(pns);tbs.hsTabs();return div};$.fn.hsTabs=function(rel){var box=$(this);if(!rel){if(box.attr("data-target")){rel=_hsTarget(this,box.attr("data-target"));rel.addClass("panes")}else{rel=box.siblings(".panes")}}box.data("rel",rel);rel.data("rel",box);if(!box.has(".active").size()){box.find("li>a").first().click()}return box};$.fn.hsTaba=function(url){var box=$(this);var tab;if(!url){url="";tab=[]}else{tab=box.find("[data-for='"+url+"']").closest("li")}if(!tab.length){tab=$("<li></li>").attr("data-for",url).appendTo(box).append($('<a href="javascript:;"></a>').append("<span></span>").append('<span class="close">&times;</span>'));return[tab,$("<div></div>").appendTo(box.data("rel"))]}else{return[tab,box.data("rel").children().eq(tab.index())]}};$.fn._hsConfig=function(){var obj={};var arr=jQuery(this).find("param");for(var i=0;i<arr.length;i++){var n=jQuery(arr[i]).attr("name");var v=jQuery(arr[i]).attr("value");switch(v.substring(0,2)){case"S:":v=v.substring(2);break;case"N:":v=v.substring(2);v=parseFloat(v);break;case"B:":v=v.substring(2);v=/(true|yes|ok|t|y|1)/i.test(v);break;default:(function(){if(/^\s*(\[.*\]|\{.*\})\s*$/.test(v)){v=eval("("+v+")")}else{if(/^\s*(\(.*\))\s*$/.test(v)){v=eval(v)}}}).call(this)}if(n){n=n.replace(/#.*$/,".");hsSetValue(obj,n,v)}}return obj};$.fn._hsTarget=function(selr){var elem=this;var flag=selr.charAt(0);var salr=selr.substr(1);switch(flag){case"@":do{var x;x=elem.closest(".panes");if(x.size()){elem=x;break}x=elem.closest(".openbox");if(x.size()){elem=x;break}x=elem.closest(".loadbox");if(x.size()){elem=x;break}}while(false);return salr?jQuery(salr,elem):elem;case">":return salr?jQuery(selr,elem):elem;default:return jQuery(selr)}};$.fn._hsConstr=function(opts,func){var elem=this;var name=func.name||/^function (\w+)/.exec(func.toString())[1];var inst=elem.data(name);if(!inst){inst=new func(opts,elem);elem.data(name,inst);elem.addClass(name)}if(opts){for(var k in opts){if("_"===k.substring(0,1)||inst[k]!==undefined){inst[k]=opts[k]}}}return inst};$.propHooks.choosed={get:function(elem){return elem.checked?true:(elem.indeterminate?null:false)},set:function(elem,stat){if(stat===null){elem.checked=false;elem.indeterminate=true}else{elem.checked=!!stat;elem.indeterminate=false}}};$(document).on("ajaxError",function(evt,xhr,cnf){var rst=hsResponObj(xhr);if(typeof(cnf.action)==="undefined"){return}if(typeof(cnf.button)!=="undefined"){$(cnf.button).trigger(cnf.action+"Error",evt,rst)}else{if(cnf.context instanceof HsForm){cnf.context.formBox.trigger(cnf.action+"Error",evt,rst)}else{if(cnf.context instanceof HsList){cnf.context.listBox.trigger(cnf.action+"Error",evt,rst)}else{if(cnf.context instanceof HsTree){cnf.context.treeBox.trigger(cnf.action+"Error",evt,rst)}}}}}).on("hsReady",function(){$(this).find(".i18n,[data-i18n]").each(function(){var lang,lxng,lget,lset,that=this;if($(this).is("[placeholder]")){lget=function(){lang=$(that).atrr("placeholder")};lset=function(){$(that).attr("placeholder",lxng)}}else{lget=function(){lang=$(that).text()};lset=function(){$(that).text(lxng)}}lang=$(this).attr("data-i18n");if(lang==null){lget()}lxng=hsGetLang(lang);if(lxng!=lang){lset()}})}).on("click","[data-toggle=hsLoad]",function(evt){var box=$(this).attr("data-target");var url=$(this).attr("data-href");if(box){box=$(this)._hsTarget(box);box.hsLoad(url)}evt.stopPropagation()}).on("click","[data-toggle=hsOpen]",function(evt){var box=$(this).attr("data-target");var url=$(this).attr("data-href");if(box){box=$(this)._hsTarget(box);box.hsOpen(url)}else{$.hsOpen(url)}evt.stopPropagation()}).on("click",".nav>li>a",function(evt){var tab=$(this).parent();var idx=tab.index();var nav=tab.closest(".nav");var pns=nav.data("rel");nav.children().removeClass("active").eq(idx).addClass("active").show();if(pns){pns.children().hide().eq(idx).show()}evt.stopPropagation()}).on("click",".nav>li>a>.close",function(evt){$(this).closest("a").hsClose();evt.stopPropagation()}).on("click",".close,.cancel,.revoke",function(evt){$(this).closest(".modal,.openbox").hsClose();evt.stopPropagation()}).on("click",".dropdown-toggle",function(evt){if($(evt.target).is(".dropdown-deny")){return}var body=$(this).siblings(".dropdown-body");if(body.size()==0){return}var cont=$(this).parent();cont.toggleClass("dropup");body.toggleClass("invisible",!cont.is(".dropup"));evt.stopPropagation()}).on("click","select[multiple]",function(evt){if(evt.shiftKey||evt.ctrlKey||evt.altKey){return}var vals=$(this).data("vals")||[];var valz=$(this).val();if(!valz||valz.length===0){vals=[]}else{$.each(valz,function(x,v){var i=$.inArray(v,vals);if(i>=0){vals.splice(i,1)}else{vals.push(v)}})}$(this).data("vals",vals);$(this).val(vals)});$(function(){$(document).hsReady()})})(jQuery);

/**
 * Form Module
 * @author Hongs
 * @version 15.3.3
 */
function HsForm(b,c){c=jQuery(c);c.data("HsForm",this);c.addClass("HsForm");var p=c.closest(".loadbox");var h=c.find("form");var l=hsGetValue(b,"saveUrl");var f=hsGetValue(b,"loadUrl");var m=hsGetValue(b,"loadMode",1);var o=hsGetValue(b,"idKey","id");if(h.length===0){h=c}this.context=c;this.loadBox=p;this.formBox=h;if(b){for(var e in b){if("_"===e.substring(0,1)||this[e]!==undefined){this[e]=b[e]}}}var q,g,d,r;var j=[];m=parseInt(m);if(1&m){q=hsSerialArr(p.data("url"));for(g=0;g<q.length;g++){j.push(q[g])}q=hsSerialArr(p.data("data"));for(g=0;g<q.length;g++){j.push(q[g])}}q=hsSerialArr(f);for(g=0;g<q.length;g++){j.push(q[g])}q=hsGetSeria(j,o);if((2&m)||q){this.load(f,j)}else{this.fillEnum({})}var d,r;for(g=0;g<j.length;g++){d=j[g].name;r=j[g].value;if(d===o&&r==="0"){continue}h.find("[name='"+d+"']").val(r);h.find("[data-pn='"+d+"']").val(r)}this.valiInit();this.saveInit(l)}HsForm.prototype={load:function(a,b){jQuery.hsAjax({url:a,data:b,type:"POST",dataType:"json",action:"load",async:false,cache:false,context:this,success:this.loadBack})},loadBack:function(a){a=hsResponObj(a);if(a.ok===false){return}this.formBox.trigger("loadOver",[a]);if(a["enum"]){this.fillEnum(a["enum"])}if(a.info){this.fillInfo(a.info)}else{if(a.list&&a.list[0]){this.fillInfo(a.list[0])}}this.formBox.trigger("loadBack",[a])},fillEnum:function(b){var d,a,f,h,e,c,g;d=this.formBox.find("select[name],[data-fn]");a={};for(f=0;f<d.length;f++){h=jQuery(d[f]).attr("name");if(!h){h=jQuery(d[f]).attr("data-fn")}c=b[h];if(!c){c=hsGetValue(b,h)}a[h]=c}this._enum=b;for(h in a){c=a[h];f=1;g=this.formBox.find('[name="'+h+'"]');if(g.length==0){f=0;g=this.formBox.find('[data-fn="'+h+'"]')}if(typeof(this["_fill_"+h])!=="undefined"){c=this["_fill_"+h].call(this,g,c,h,"enum")}else{if(g.attr("data-ft")){e=g.attr("data-ft");if(typeof(this["_fill_"+e])!=="undefined"){c=this["_fill_"+e].call(this,g,c,h,"enum")}}}if(!c){continue}if(f==0){this._fill__review(g,c,h,"enum")}else{if(g.prop("tagName")=="SELECT"){this._fill__select(g,c,h,"enum")}}}delete this._enum},fillInfo:function(f){var b,g,d,h,c,a,e;b=this.formBox.find("select[name],[data-fn],input[name],textarea[name]");g={};for(d=0;d<b.length;d++){h=jQuery(b[d]).attr("name");if(!h){h=jQuery(b[d]).attr("data-fn")}a=f[h];if(!a){a=hsGetValue(f,h)}g[h]=a}this._info=f;for(h in g){a=g[h];d=1;e=this.formBox.find('[name="'+h+'"]');if(e.length==0){d=0;e=this.formBox.find('[data-fn="'+h+'"]')}if(typeof(this["_fill_"+h])!=="undefined"){a=this["_fill_"+h].call(this,e,a,h,"info")}else{if(e.attr("data-ft")){c=e.attr("data-ft");if(typeof(this["_fill_"+c])!=="undefined"){a=this["_fill_"+c].call(this,e,a,h,"info")}}}if(!a&&(a!==0||a!=="")){continue}if(d==0){a=this._fill__review(e,a,h,"info");e.text(a)}else{if(e.attr("type")=="checkbox"||e.attr("type")=="radio"){jQuery.each(!jQuery.isArray(a)?[a]:a,function(k,j){e.filter("[value='"+j+"']").prop("checked",true).change()})}else{e.val(a).change()}}}delete this._info},saveInit:function(h){var b=this.formBox.attr("action")||h;var i=this.formBox.attr("method");var e=this.formBox.attr("enctype");var f=this.formBox;var g=this;this.formBox.attr("action",b);this.formBox.on("submit",function(){return g.verifies()});if(e==="multipart/form-data"){if(f.attr("target")==null){var c="_"+((new Date()).getTime()%86400000)+"_"+Math.floor(Math.random()*1000);var a="width:0; height:0; border:0; margin:0; padding:0; overflow:hidden; visibility:hidden;";var d=jQuery('<iframe src="about:blank" name="'+c+'" style="'+a+'"></iframe>');f.attr("target",c).before(d);d.on("load",function(){var j=d[0].contentDocument||d[0].contentWindow.document;if(j.location.href=="about:blank"){return}var k=j.body.innerHTML.replace(/(^<PRE.*?>|<\/PRE>$)/igm,"");g.saveBack(k)})}this.formBox.attr("action",hsFixUri(b))}else{f.on("submit",function(j){if(j.isDefaultPrevented()){return}j.preventDefault();jQuery.hsAjax({url:b,data:hsSerialArr(f),type:i||"POST",dataType:"json",action:"save",async:false,cache:false,global:false,context:g,complete:g.saveBack,error:function(){return false}})})}},saveBack:function(c){c=hsResponObj(c,true);if(c.ok===false){var a=new jQuery.Event("saveFail");this.formBox.trigger(a,[c]);this.formBox.find(".form-group").removeClass("has-error");this.formBox.find(".help-block").addClass("invisible");if(c.errors){for(var d in c.errors){var b=c.errors[d];this.haserror(d,b)}}if(c.msg){alert(c.msg)}else{alert(hsGetLang("error.unkwn"))}}else{if(c.msg){jQuery.hsNote(c.msg,"alert-success")}var a=new jQuery.Event("saveBack");this.formBox.trigger(a,[c]);if(!a.isDefaultPrevented()){this.loadBox.hsClose()}}},_fill__review:function(h,l,d,m){if(m==="enum"){h.data("enum",l);return l}var k=h.data("enum");h.removeData("enum");if(!k){return l}var e=h.attr("data-vk");if(!e){e=0}var o=h.attr("data-tk");if(!o){o=1}var f,g,j={};for(f==0;f<k.length;f++){g=k[f];j[g[e]]=j[g[o]]}if(!jQuery.isArray(l)){l=[l]}h.empty();for(f==0;f<l.length;f++){h.append(jQuery("<li></li>").text(j[l[f]]))}},_fill__select:function(f,a,h,e){if(e!=="enum"){return a}var g=f.attr("data-vk");if(!g){g=0}var b=f.attr("data-tk");if(!b){b=1}for(var d=0;d<a.length;d++){var c=jQuery("<option></option>");c.val(hsGetValue(a[d],g)).text(hsGetValue(a[d],b)).data("data",a[d]);f.append(c)}f.change().click()},_fill__radio:function(f,a,h,e){if(e!=="enum"){return a}var g=f.attr("data-vk");if(!g){g=0}var b=f.attr("data-tk");if(!b){b=1}for(var d=0;d<a.length;d++){var c=jQuery('<label><input type="radio"/><span></span></label>');c.find("input").attr("name",h).data(a[d]).val(hsGetValue(a[d],g));c.find("span").text(hsGetValue(a[d],b));f.append(c)}f.find(":radio").first().change()},_fill__check:function(f,a,h,e){if(e!=="enum"){return a}var g=f.attr("data-vk");if(!g){g=0}var b=f.attr("data-tk");if(!b){b=1}for(var d=0;d<a.length;d++){var c=jQuery('<label><input type="checkbox"/><span></span></label>');c.find("input").attr("name",h).data(a[d]).val(hsGetValue(a[d],g));c.find("span").text(hsGetValue(a[d],b));f.append(c)}f.find(":checkbox").first().change()},_fill__chack:function(g,l,a,o){if(o!=="enum"){return l}var c=g.attr("data-vk");if(!c){c=0}var r=g.attr("data-tk");if(!r){r=1}var b=g.attr("data-vl");if(!b){b=0}var p=g.attr("data-tl");if(!p){p=1}for(var e=0;e<l.length;e++){var m=l[e][b];var q=l[e][p];var k=jQuery('<fieldset><legend class="dropdown-toggle"><input type="checkbox" class="checkall dropdown-deny"/>&nbsp;<span></span><b class="caret"></b></legend><div class="dropdown-body checkbox"></div></fieldset>');k.find("span").first().text(q);g.append(k);k=k.find("div");for(var d=0;d<m.length;d++){var h=m[d];var f=jQuery('<label class="col-md-2"><input type="checkbox"/><span></span></label>');f.find("input").attr("name",a).data(h).val(hsGetValue(h,c));f.find("span").text(hsGetValue(h,r));k.append(f)}}g.find(":checkbox").first().change()},valiInit:function(){var a=this;this.formBox.attr("novalidate","novalidate");this.formBox.on("change","input,select,textarea,[data-fn]",function(){var b=jQuery(this);a.validate(b.attr("name")||b.attr("data-fn"))})},verifies:function(){var b=true;var a={};this.formBox.find("input,select,textarea,[data-fn]").each(function(){var e=jQuery(this);var f=e.attr("name")||e.attr("data-fn");if(!f){return true}if(a[f]===undefined){a[f]=e}else{a[f].add(e)}});for(var c in a){var d=this.validate(a[c]);if(d==false){b=false}}return b},validate:function(c){if(typeof c=="string"){c=this.formBox.find('[name="'+c+'"],[data-fn="'+c+'"]')}else{c=jQuery(c)}for(var a in this.rules){if(!c.is(a)){continue}var b=this.rules[a].call(this,c.val(),c);if(b!==true){b=c.attr("data-message")||b||hsGetLang("form.haserror");this.haserror(c,b);return false}else{this.haserror(c)}}return true},haserror:function(d,c){if(typeof d=="string"){d=this.formBox.find('[name="'+d+'"],[data-fn="'+d+'"]')}else{d=jQuery(d)}var a=d.closest(".form-group");var b=a.find(".help-block");if(b.size()==0){b=jQuery('<div class="help-block"></div>').appendTo(a)}if(c==undefined){a.removeClass("has-error");b.addClass("invisible")}else{a.addClass("has-error");b.removeClass("invisible");b.text(c)}},rules:{"[required],[data-required]":function(b,a){if(a.is("select")){if(!b){return hsGetLang("form.requires")}}else{if(a.is(":checkbox,:radio")){if(!a.filter(":checked").length){return hsGetLang("form.requires")}}else{if(a.is(".checkbox")){if(!a.find(":checked").length){return hsGetLang("form.requires")}}else{if(a.is("ul,div")){if(!a.find(":hidden").length){return hsGetLang("form.requires")}}else{if(!b){return hsGetLang("form.required")}}}}}return true},"[pattern],[data-parttern]":function(e,d){var b=d.attr("data-pattern")||d.attr("pattern");var a=d.attr("data-message");var c=/^\/(.*)\/([gim])?$/.exec(b);if(c){b=new RegExp(c[1],c[2])}else{b=new RegExp(b)}if(!b.test(e)){return hsGetLang(a)}return true},"[maxlength],[data-maxlength]":function(c,b){var a=b.attr("maxlength")||b.attr("data-maxlength");if(c.length>a){return hsGetLang("form.gt.maxlength",[a])}return true},"[minlength],[data-minlength]":function(c,b){var a=b.attr("minlength")||b.attr("data-minlength");if(c.length<a){return hsGetLang("form.lt.minlength",[a])}return true},"[max],[data-max]":function(c,b){var a=b.attr("max")||b.attr("data-max");if(c>a){return hsGetLang("form.lt.min",[a])}return true},"[min],[data-min]":function(c,b){var a=b.attr("min")||b.attr("data-min");if(c<a){return hsGetLang("form.lt.min",[a])}return true},"[type=number]":function(a){if(!/^-?[0-9]*(\.[0-9]+)?$/.test(a)){return hsGetLang("form.is.not.number")}return true},"[type=email]":function(a){if(!/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i.test(a)){return hsGetLang("form.is.not.email")}return true},"[type=url]":function(a){if(!/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i.test(a)){return hsGetLang("form.is.not.url")}return true},"[data-validate]":function(e,d){var c=d.attr("data-validate");var b=d.data()?d.data():window;try{return hsGetValue(b,c).call(this,e,d)}catch(a){if(window.console){window.console.log("Call "+c+" error: "+a,e,d)}return false}},"[data-verify]":function(f,c,b){if(!f){return true}var a=true;var e=this.formBox;var d={n:c.attr("name"),v:f};if(!b){b=c.attr("data-verify")}b=b.replace(/\{(.*?)\}/g,function(g,h){return e.find("[name='"+h+"']").val()||""});jQuery.hsAjax({url:b,data:d,type:"POST",dataType:"json",async:false,cache:false,success:function(g){if(g.info&&!jQuery.isEmptyObject(g.info)){a=true}else{if(g.list&&g.list.length){a=true}else{a=g.ok||g.msg}}}});return a},"[data-unique]":function(c,b){var a=this.rules["[data-verify]"].call(this,c,b,b.attr("data-unique"));if(typeof a==="string"){return a}else{if(!a){return hsGetLang("form.is.not.unique")}}return true},"[data-exists]":function(c,b){var a=this.rules["[data-verify]"].call(this,c,b,b.attr("data-exists"));if(typeof a==="string"){return a}else{if(!a){return hsGetLang("form.is.not.exists")}}return true},"[data-relate]":function(d,c){var b=c.attr("data-relate");var a=this.formBox.find("[name="+b+"]");if(a.val()){this.validate(a)}return true},"[data-repeat]":function(d,c){var b=c.attr("data-repeat");var a=this.formBox.find("[name="+b+"]");if(a.val()!=d){return hsGetLang("form.is.not.repeat")}return true}}};jQuery.fn.hsForm=function(a){return this._hsConstr(a,HsForm)};(function(a){a(document).on("save","form",function(b){if(b.isDefaultPrevented()){return}var c=a(this).find(":submit");c.prop("disabled",true);c.data("txt",c.text());c.text(hsGetLang("form.sending"))}).on("saveBack saveFail","form",function(){var c=a(this).find(":submit");var b=c.data("txt");if(b){c.text(b)}c.prop("disabled",false)}).on("change","fieldset .checkall",function(b){this.indeterminate=false;var d=a(this).closest("fieldset");var c=a(this).prop("checked");d.find(":checkbox:not(.checkall)").prop("checked",c).trigger("change")}).on("change","fieldset :checkbox:not(.checkall)",function(d){var e=a(this).closest("fieldset");var c=e.find(":checkbox:not(.checkall)").length;var b=e.find(":checkbox:not(.checkall):checked").length;e.find(".checkall").prop("choosed",c&&c==b?true:(b&&c!=b?null:false))})})(jQuery);

/**
 * List Module
 * @author Hongs
 * @version 15.3.3
 */
function HsList(j,c){c=jQuery(c);c.data("HsList",this);c.addClass("HsList");var o=c.closest(".loadbox");var e=c.find(".listbox");var y=c.find(".pagebox");var v=c.find(".findbox");var g=hsGetValue(j,"loadUrl");var z=hsGetValue(j,"openUrls");var d=hsGetValue(j,"sendUrls");var l=hsGetValue(j,"loadMode",1);this.pageKey=hsGetValue(j,"pageKey",hsGetConf("page.key","page"));this.sortKey=hsGetValue(j,"sortKey",hsGetConf("sort.key","sort"));this.rowsPerPage=hsGetConf("rows.per.page",20);this.lnksPerPage=hsGetConf("lnks.per.page",5);this.context=c;this.loadBox=o;this.listBox=e;this.pageBox=y;if(j){for(var s in j){if("_"===s.substring(0,1)||this[s]!==undefined){this[s]=j[s]}}}var t,x,q,r,h;var f=this;function p(k){var D=jQuery(this);var a=k.data[1];var A=k.data[2];switch(a){case"{CONTEXT}":a=c;break;case"{LOADBOX}":a=o;break;case"{AUTOBOX}":a=D._hsTarget("@");break;case"{TABSBOX}":a=c.closest(".panes").data("rel");a=a.hsTaba(c.attr("id"));a=a[0];break;default:a=D._hsTarget(a)}if(a){a=jQuery(a)}var B=D.closest(".tooltip");if(B.length){D=B.data("trigger")}if(typeof(A)==="function"){A.call(D,a,f);return}if(0<=A.indexOf("{ID}")){var C;if(0<=jQuery.inArray(e[0],D.parents())){C=f.getRow(D)}else{C=f.getOne()}if(C==null){return}var i=C.val();A=A.replace("{ID}",encodeURIComponent(i))}f.open(D,a,A)}if(z){jQuery.each(z,function(m,k){switch(k.length){case 3:q=k[0];h=k[1];r=k[2];break;case 2:q=k[0];h=k[1];r=undefined;break;default:return}if(typeof(q)==="string"){c.on("click",q,[q,r,h],p)}else{if(q){q.on("click",[q,r,h],p)}}})}function w(i){var C=jQuery(this);var a=i.data[1];var k=i.data[2];var A=C.closest(".tooltip");if(A.length){C=A.data("trigger")}if(typeof(k)==="function"){k.call(C,a,f);return}var B;if(-1!=jQuery.inArray(e[0],C.parents())){B=f.getRow(C)}else{B=f.getAll()}if(B==null){return}f.send(C,a,k,B)}if(d){jQuery.each(d,function(m,k){switch(k.length){case 3:q=k[0];h=k[1];r=k[2];break;case 2:q=k[0];h=k[1];r=undefined;break;default:return}if(typeof(q)==="string"){c.on("click",q,[q,r,h],w)}else{if(q){q.on("click",[q,r,h],w)}}})}if(v.length){v.on("submit",function(){f.load(g,this);return false})}if(g){var b=[];l=parseInt(l);if(1&l){x=hsSerialArr(o.data("url"));for(t=0;t<x.length;t++){b.push(x[t])}x=hsSerialArr(o.data("data"));for(t=0;t<x.length;t++){b.push(x[t])}}x=hsSerialArr(g);for(t=0;t<x.length;t++){b.push(x[t])}this.load(g,b)}}HsList.prototype={load:function(a,b){if(a){this._url=a}if(b){this._data=hsSerialArr(b)}jQuery.hsAjax({url:this._url,data:this._data,type:"POST",dataType:"json",action:"load",async:false,cache:false,context:this,success:this.loadBack})},loadBack:function(a){a=hsResponObj(a);if(a.ok===false){return}this.listBox.trigger("loadOver",[a]);if(a.list){this.fillList(a.list)}if(a.page){this.fillPage(a.page)}this.listBox.trigger("loadBack",[a])},fillList:function(k){var e,l,c,g,s,q,o,f,d,b,r,p;e=this.listBox.find("tbody");e.empty();g=this.listBox.find("thead th, thead td");s=[];q=[];o={};for(f=0;f<g.length;f++){c=jQuery(g[f]);s.push(c.attr("class"));q.push(c.attr("data-fn"));if(c.attr("data-ft")){o[c.attr("data-fn")]=c.attr("data-ft")}if(c.hasClass("sortable")){if(c.find(".sort-ico").size()==0){var h=this;c.append('<span class="sort-ico"></span>');c.click(function(){var n=jQuery(this);var i=n.attr("data-sn")||n.attr("data-fn");var j="";if(n.hasClass("sort-a-z")){j="-"+i}else{if(!n.hasClass("sort-z-a")){j=i}}hsSetSeria(h._data,h.sortKey,j);h.load()})}var a=hsGetSeria(this._data,this.sortKey);var m=c.attr("data-sn")||c.attr("data-fn");c.removeClass("sort-a-z sort-z-a");if(a==m){c.addClass("sort-a-z")}else{if(a=="-"+m){c.addClass("sort-z-a")}}}}for(f=0;f<k.length;f++){l=jQuery("<tr></tr>");e.append(l);this._info=k[f];for(d=0;d<q.length;d++){c=jQuery("<td></td>");c.attr("class",s[d]);l.append(c);b=q[d];if(!b){continue}p=hsGetValue(k[f],b)||"";if(typeof(this["_fill_"+b])!=="undefined"){p=this["_fill_"+b].call(this,c,p,b);if(!p){continue}}else{if(typeof(o[b])!=="undefined"){r=o[b];if(typeof(this["_fill_"+r])!=="undefined"){p=this["_fill_"+r].call(this,c,p,b);if(!p){continue}}}}c.text(p)}}if(typeof(this._info)!=="undefined"){delete this._info}},fillPage:function(j){switch(j.err){case 1:this.pageBox.empty().append('<div class="alert alert-warning">'+hsGetLang("list.empty")+"</div>");this.listBox.children().hide();return;case 2:this.pageBox.empty().append('<div class="alert alert-warning">'+hsGetLang("list.outof")+"</div>");this.listBox.children().hide();hsSetSerial(this._data,"page",1);this.load();return;default:this.listBox.children().show()}var f,a,l,d,b,g,h=this;a=j.page||1;l=j.pagecount||1;b=Math.floor((a-1)/this.lnksPerPage);b=b*this.lnksPerPage+1;g=b+this.lnksPerPage-1;if(l<g){g=l}this.pageBox.empty();var c=jQuery('<ul class="pagination"></ul>').appendTo(this.pageBox);var e=c;var k=c;if(1!=a){d=a-1;e.append(jQuery('<li class="page-prev"><a href="javascript:;" data-pn="'+d+'" title="'+hsGetLang("list.prev.page")+'">&laquo;</a></li>'))}else{e.append(jQuery('<li class="page-prev disabled"><a href="javascript:;" title="'+hsGetLang("list.prev.page")+'">&laquo;</a></li>'))}if(1<b){k.append(jQuery('<li class="page-home"><a href="javascript:;" data-pn="'+1+'">'+1+"</a></li>"))}if(1<b-1){k.append(jQuery('<li class="unit-prev"><a href="javascript:;" data-pn="'+(b-1)+'">&hellip;</a></li>'))}for(f=b;f<g+1;f++){k.append(jQuery('<li class="page-link'+(f==a?" active":"")+'"><a href="javascript:;" data-pn="'+f+'">'+f+"</a></li>"))}if(l>g+1){k.append(jQuery('<li class="unit-next"><a href="javascript:;" data-pn="'+(g+1)+'">&hellip;</a></li>'))}if(l>g){k.append(jQuery('<li class="page-last"><a href="javascript:;" data-pn="'+l+'">'+l+"</a></li>"))}if(l!=a){d=a+1;e.append(jQuery('<li class="page-next"><a href="javascript:;" data-pn="'+d+'" title="'+hsGetLang("list.next.page")+'">&raquo;</a></li>'))}else{e.append(jQuery('<li class="page-next disabled"><a href="javascript:;" title="'+hsGetLang("list.next.page")+'">&raquo;</a></li>'))}if(j.uncertain&&l==g+1){k.find(".page-last").addClass("lnks-next").find("a").html("&hellip;")}this.pageBox.find("[data-pn="+a+"]").addClass("page-curr");this.pageBox.find("[data-pn]").on("click",function(i){hsSetSeria(h._data,h.pageKey,jQuery(this).attr("data-pn"));i.preventDefault();h.load()})},send:function(b,d,a,c){if(d&&!confirm(d)){return}var e=jQuery.extend({},hsSerialObj(a),hsSerialObj(c||{}));jQuery.hsAjax({url:a,data:c,type:"POST",dataType:"json",action:"send",button:b,async:false,cache:false,context:this,success:function(f){this.sendBack(b,f,e)}})},sendBack:function(b,d,c){d=hsResponObj(d);if(d.ok===false){return}var a=new jQuery.Event("sendBack");b.trigger(a,[d,c]);if(a.isDefaultPrevented()){return}this.load()},open:function(b,d,a,e){var c=this;var f=jQuery.extend({},hsSerialObj(a),hsSerialObj(e||{}));if(d=="@"){d=jQuery(b).closest(".loadbox")}if(d){d.hsOpen(a,e,function(){c.openBack(b,jQuery(this),f)}).data("rel",b.closest(".loadbox")[0])}else{$.hsOpen(a,e,function(){c.openBack(b,jQuery(this),f)})}},openBack:function(a,c,d){var b=this;a.trigger("openBack",[c,d]);c.on("saveBack",function(e,f){if(e.isDefaultPrevented()){return}a.trigger(e,[f,d]);if(e.isDefaultPrevented()){return}b.load()})},getRow:function(a){return a.parents("tr").find(".checkone").filter(":checkbox,:radio,:hidden")},getAll:function(){var a=this.context.find(".checkone").filter(":checked");if(a.length==0){alert(hsGetLang("list.get.all"));return null}else{return a}},getOne:function(){var a=this.context.find(".checkone").filter(":checked");if(a.length!=1){alert(hsGetLang("list.get.one"));return null}else{return a}},_fill__admin:function(d,a,c){var b=this.listBox.find('thead [data-fn="'+c+'"]');d.append(b.find(".invisible").clone().removeClass("invisible")).hsInit();return false},_fill__check:function(c,a,b){jQuery('<input type="checkbox" class="input-checkbox checkone"/>').attr("name",b).val(a).appendTo(c);return false},_fill__radio:function(c,a,b){jQuery('<input type="radio" class="input-radio checkone"/>').attr("name",b).val(a).appendTo(c);return false},_fill__htime:function(e,a,d){var c=new Date();var b=hsPrsDate(a,hsGetLang("datetime.format"));if(c.getFullYear()==b.getFullYear()&&c.getMonth()==b.getMonth()&&c.getDate()==b.getDate()){return hsGetLang("time.today",[hsFmtDate(a,hsGetLang("time.format"))])}else{return hsFmtDate(a,hsGetLang("date.format"))}},_fill__hdate:function(e,a,d){var c=new Date();var b=hsPrsDate(a,hsGetLang("date.format"));if(c.getFullYear()==b.getFullYear()&&c.getMonth()==b.getMonth()&&c.getDate()==b.getDate()){return hsGetLang("date.today")}else{return hsFmtDate(a,hsGetLang("date.format"))}},_fill__datetime:function(c,a,b){return hsFmtDate(a,hsGetLang("datetime.format"))},_fill__time:function(c,a,b){return hsFmtDate(a,hsGetLang("time.format"))},_fill__date:function(c,a,b){return hsFmtDate(a,hsGetLang("date.format"))}};jQuery.fn.hsList=function(a){return this._hsConstr(a,HsList)};(function(a){a(document).on("click",".listbox tbody td",function(b){if(this!=b.target){return}var d=a(this).closest("tr");var c=d.find(".checkone");if(this!=c.closest("td")){d.closest("tbody").find(".checkone").not(c).prop("checked",false)}c.prop("checked",!c.prop("checked")).change()}).on("change",".HsList .checkone",function(){var d=a(this).closest(".HsList");var c=d.find(".checkone").length;var b=d.find(".checkone:checked").length;d.find(".for-select").prop("disabled",b!=1);d.find(".for-checks").prop("disabled",b==0);d.find(".checkall").prop("choosed",c&&c==b?true:(b&&c!=b?null:false))}).on("change",".HsList .checkall",function(){this.indeterminate=false;var c=a(this).closest(".HsList");var b=a(this).prop("checked");c.find(".checkone").prop("checked",b).trigger("change")}).on("loadBack",".HsList .listbox",function(){var b=a(this).closest(".HsList");b.find(".for-select,.for-checks").prop("disabled",true);b.find(".checkone").change()})})(jQuery);

/**
 * Tree Module
 * @author Hongs
 * @version 15.3.3
 */
function HsTree(l,c){c=jQuery(c);c.data("HsTree",this);c.addClass("HsTree");var p=c.closest(".loadbox");var q=c.find(".treebox");var x=c.find(".findbox");var h=hsGetValue(l,"loadUrl");var A=hsGetValue(l,"openUrls");var d=hsGetValue(l,"sendUrls");var e=hsGetValue(l,"linkUrls");var o=hsGetValue(l,"loadMode",0);this.idKey=hsGetValue(l,"idKey","id");this.pidKey=hsGetValue(l,"pidKey","pid");this.nameKey=hsGetValue(l,"nameKey","name");this.noteKey=hsGetValue(l,"noteKey");this.typeKey=hsGetValue(l,"typeKey");this.cnumKey=hsGetValue(l,"cnumKey");var b={id:hsGetValue(l,"rootId",hsGetConf("tree.root.id","0")),name:hsGetValue(l,"rootName",hsGetLang("tree.root.name")),note:hsGetValue(l,"rootNote",hsGetLang("tree.root.note"))};this.context=c;this.loadBox=p;this.treeBox=q;if(l){for(var v in l){if("_"===v.substring(0,1)||this[v]!==undefined){this[v]=l[v]}}}var w,z,s,t,j;var g=this;function r(k){var D=jQuery(this);var a=k.data[1];var B=k.data[2];switch(a){case"{CONTEXT}":a=c;break;case"{LOADBOX}":a=p;break;case"{AUTOBOX}":a=D._hsTarget("@");break;case"{TABSBOX}":a=c.closest(".panes").data("rel");a=a.hsTaba(c.attr("id"));a=a[0];break;default:a=D._hsTarget(a)}if(a){a=jQuery(a)}var C=D.closest(".tooltip");if(C.length){D=C.data("trigger")}if(typeof(B)==="function"){B.call(g,D,a);return}if(0<=B.indexOf("{ID}")){var i;if(0<=jQuery.inArray(q[0],D.parents())){i=g.getId(D)}else{i=g.getSid()}if(i==null){return}B=B.replace("{ID}",encodeURIComponent(i))}g.open(D,a,B)}if(A){jQuery.each(A,function(m,k){switch(k.length){case 3:s=k[0];j=k[1];t=k[2];break;case 2:s=k[0];j=k[1];t=undefined;break;default:return}if(typeof(s)==="string"){c.on("click",s,[s,t,j],r)}else{if(s){s.on("click",[s,t,j],r)}}})}function y(k){var E=jQuery(this);var a=k.data[1];var B=k.data[2];var D=E.closest(".tooltip");if(D.length){E=D.data("trigger")}if(typeof(B)==="function"){B.call(g,E,a);return}var i;if(-1!=jQuery.inArray(q[0],E.parents())){i=g.getId(E)}else{i=g.getSid()}if(i==null){return}var C={};C[g.idKey]=i;g.send(E,a,B,C)}if(d){jQuery.each(d,function(m,k){switch(k.length){case 3:s=k[0];j=k[1];t=k[2];break;case 2:s=k[0];j=k[1];t=undefined;break;default:return}if(typeof(s)==="string"){c.on("click",s,[s,t,j],y)}else{if(s){s.on("click",[s,t,j],y)}}})}if(e){q.on("select",function(a,m){for(var k=0;k<e.length;k++){jQuery(e[k][0]).hsLoad(e[k][1].replace("{ID}",encodeURIComponent(m)))}})}if(x.length){x.on("submit",function(){g.find(h,this);return true})}q.on("click",".tree-node td.tree-hand",function(){g.toggle(jQuery(this).closest(".tree-node"))});q.on("click",".tree-node td:not(.tree-hand)",function(){g.select(jQuery(this).closest(".tree-node"))});var f=jQuery('<div class="tree-node tree-root" id="tree-node-'+b.id+'"></div>').appendTo(q);this.fillInfo(b,f);this.select(b.id);this.load(h,b.id)}HsTree.prototype={load:function(b,a){if(b){this._url=b}if(a){this._pid=a}var c={};c[this.pidKey]=this._pid;jQuery.hsAjax({url:this._url,data:c,type:"POST",dataType:"json",action:"load",async:false,cache:false,context:this,success:function(d){this.loadBack(d,a)}})},loadBack:function(c,b){c=hsResponObj(c);var a=this.getSid();if(c.ok===false){return}this.treeBox.trigger("loadOver",[c,b]);if(c.list){this.fillList(c.list,b)}this.treeBox.trigger("loadBack",[c,b]);if(this.treeBox.find("#tree-node-"+a).length==0){this.select(b)}},fillList:function(g,f){var d,j,c,a;j=this.treeBox.find("#tree-node-"+f);d=j.children(".tree-list:first");if(g.length==0){j.removeClass("tree-fold").removeClass("tree-open");d.remove();return}j.addClass("tree-open");if(d.length==0){d=jQuery('<div class="tree-list"></div>');d.appendTo(j)}var h,b,e={};e[f]=d;for(c=g.length-1;c>-1;c--){a=hsGetValue(g[c],this.idKey);j=this.treeBox.find("#tree-node-"+a);if(j.length==0){j=jQuery('<div class="tree-node"></div>');j.attr("id","tree-node-"+a)}else{j.find("table:first").empty();h=this.getPid(j);b=j.closest(".tree-list");if(h!=f){e[h]=b}}j.prependTo(d);this.fillInfo(g[c],j)}for(c in e){this.fillCnum(g.length,e[c])}},fillInfo:function(d,a){var c=jQuery('<table><tbody><tr><td class="tree-hand"><span class="caret"></span></td><td class="tree-name"></td><td class="tree-cnum"></td></tr></tbody></table>');var e,b;e=hsGetValue(d,this.nameKey);c.find(".tree-name").text(e);if(typeof(this.noteKey)!=="undefined"){e=hsGetValue(d,this.noteKey);a.find(".tree-name").attr("title",e)}if(typeof(this.typeKey)!=="undefined"){b=hsGetValue(d,this.typeKey);a.addClass("tree-type-"+b)}if(typeof(this.cnumKey)!=="undefined"){e=hsGetValue(d,this.cnumKey);c.find(".tree-cnum").text(e);if(e){a.addClass("tree-fold")}}else{a.addClass("tree-fold")}if(!b){b="info"}if(typeof(this["_fill_"+b])!=="undefined"){this["_fill_"+b].call(this,c,d)}c.prependTo(a)},fillCnum:function(d,c){var b=c.closest(".tree-node");var a=c.children(".tree-node");if(typeof(d)==="undefined"){d=a.length}if(d!=a.length){for(var e=a.length-1;e>d-1;e--){jQuery(a[e]).remove()}}if(d!=0){b.find(".tree-cnum").text(d.toString())}else{b.find(".tree-cnum").hide();b.removeClass("tree-fold").removeClass("tree-open")}},find:function(a,b){},findBack:function(a){},send:function(b,d,a,c){if(d&&!confirm(d)){return}var e=jQuery.extend({},hsSerialObj(a),hsSerialObj(c||{}));jQuery.hsAjax({url:a,data:c,type:"POST",dataType:"json",action:"send",button:b,async:false,cache:false,context:this,success:function(f){this.sendBack(b,f,e)}})},sendBack:function(b,d,c){d=hsResponObj(d);if(d.ok===false){return}var a=new jQuery.Event("sendBack");b.trigger(a,[d,c]);if(a.isDefaultPrevented()){return}if(c[this.idKey]!==undefined){this.load(null,this.getPid(c[this.idKey]))}if(c[this.pidKey]!==undefined){this.load(null,c[this.pidKey])}},open:function(b,d,a,e){var c=this;var f=jQuery.extend({},hsSerialObj(a),hsSerialObj(e||{}));if(d=="@"){d=jQuery(b).parent(".loadbox")}if(d){d.hsOpen(a,e,function(){c.openBack(b,jQuery(this),f)}).data("rel",b.closest(".loadbox")[0])}else{$.hsOpen(a,e,function(){c.openBack(b,jQuery(this),f)})}},openBack:function(a,c,d){var b=this;a.trigger("openBack",[c,d]);c.on("saveBack",function(e,f){if(e.isDefaultPrevented()){return}a.trigger(e,[f,d]);if(e.isDefaultPrevented()){return}if(d[b.idKey]!==undefined){b.load(null,b.getPid(d[b.idKey]))}else{b.load(null,b.getSid())}})},select:function(b){var a=this.getNode(b);b=this.getId(a);this.treeBox.find(".tree-node").removeClass("tree-curr");a.addClass("tree-curr").trigger("select",[b])},toggle:function(c){var b=this.getNode(c);c=this.getId(b);var a=b.children(".tree-list");a.toggle();b.trigger("toggle",[c]);if(a.length==0){this.load(null,c)}else{b.removeClass("tree-open tree-fold");a.is(":visible")?b.addClass("tree-open"):b.addClass("tree-fold")}},getNode:function(a){if(typeof(a)==="object"){return a.closest(".tree-node")}else{return this.treeBox.find("#tree-node-"+a)}},getPnode:function(a){return this.getNode(a).parent().closest(".tree-node")},getId:function(a){if(typeof(a)==="object"){return this.getId(a.attr("id"))}else{return a.toString().substr(10)}},getPid:function(a){return this.getId(this.getPnode(a))},getRid:function(){return this.getId(this.treeBox.find(".tree-root"))},getSid:function(){return this.getId(this.treeBox.find(".tree-curr"))}};jQuery.fn.hsTree=function(a){return this._hsConstr(a,HsTree)};(function(a){a(document).on("select loadBack",".HsTree .tree-node",function(){var b=a(this).closest(".HsTree");var c=b.data("HsTree");b.find(".for-select").prop("disabled",c.getSid()==c.getRid())})})(jQuery);

/**
 * Pick Module
 * @author Hongs
 * @version 15.3.3
 */
jQuery.fn.hsPick=function(url,tip,box,fil){if(fil==undefined&&typeof url=="function"){fil=url;url=tip;tip=null}else{if(url==undefined){url=tip;tip=null}}var v={};var n=box.attr("name")||box.attr("data-fn");var form=box.closest(".HsForm").data("HsForm");var mul=/(\[\]|\.\.|\.$)/.test(n);var btn=jQuery(this);if(!fil){do{fil=form["_fill_"+n];if(fil){break}var t;t=box.attr("data-ft");fil=form["_fill_"+t];if(fil){break}t=box.attr("data-fn");fil=form["_fill_"+t];if(fil){break}fil=hsFormFillPick}while(false)}if(box.is("input")){var val=box.val();var txt=btn.text();if(val){v[val]=txt}}else{box.find("li").each(function(){var opt=jQuery(this);var val=opt.find(".pickval").val();var txt=opt.find(".picktxt").text();v[val]=txt})}function pickItem(val,txt){var evt=jQuery.Event("pickItem");box.trigger(evt,arguments);if(evt.isDefaultPrevented()){return false}if(!mul){for(var key in v){delete v[key]}if(txt!==undefined){v[val]=txt}}else{if(txt!==undefined){v[val]=txt}else{delete v[val]}}return true}function pickBack(){var evt=jQuery.Event("pickBack");box.trigger(evt,[v,tip]);if(evt.isDefaultPrevented()){return false}fil.call(form,box,v,n,"data");box.trigger("change");return true}function pickOpen(){var tip=jQuery(this);tip.data("pickData",v).addClass("pickbox").toggleClass("pickmul",mul).on("saveBack",function(evt,rst){if(!rst||!rst.back||!rst.back.length){return false}if(rst.back.length==1){rst.back[1]=$(this).find(".pick-name,[name]").val()}if(!pickItem(rst.back[0],rst.back[1])||!pickBack()){return false}tip.hsClose();return false}).on("click",".ensure",function(){var btn=jQuery(this);if(!btn.closest(".openbox").is(tip)||!pickBack()){return false}tip.hsClose();return false}).on("change",".checkone",function(){var chk=jQuery(this);if(chk.closest(".HsList").data("HsList")._info){return}var val=chk.val();var txt;var inf;do{if(!chk.prop("checked")){break}inf=chk.data();if(!inf){inf=chk.attr("data-data");if(inf){inf=eval("("+inf+")")}else{inf=null}}txt=chk.attr("data-name");if(txt){break}txt=chk.closest("tr").find(".name").text();if(txt){break}var thd=chk.closest("table").find("thead");var tds=chk.closest("tr").find("td");var idx;idx=thd.find("[data-ft=name]").index();if(idx!=-1){txt=tds.eq(idx).text()}if(txt){break}idx=thd.find("[data-fn=name]").index();if(idx!=-1){txt=tds.eq(idx).text()}}while(false);if(pickItem(val,txt,inf)===false){chk.prop("checked",false);return false}})}tip.on("hsOpen",function(){box.trigger("pickOpen")});tip.on("hsClose",function(){box.trigger("pickClose")});if(tip){tip=tip.hsOpen(url,undefined,pickOpen);tip.data("rel",btn.closest(".openbox")[0])}else{tip=jQuery.hsOpen(url,undefined,pickOpen)}return tip};function hsFormFillPick(k,o,c,q){k.data("pickFunc",hsFormFillPick);var a=k.siblings("[data-toggle=hsPick]");var d=/(\[\]|\.\.|\.$)/.test(c);if(q=="info"){var p=k.attr("data-tn")||"";o=hsGetValue(this._info,p);if(!o){return}if(!d){o=[o]}}if(jQuery.isArray(o)){var e=k.attr("data-vk")||0;var s=k.attr("data-tk")||1;var m={};for(var h=0;h<o.length;h++){var f=o[h];m[f[e]]=f[s]}o=m}else{if(!jQuery.isPlainObject(o)){o={}}}if(k.is("input")){function l(t,n){var i=n.data("txt");var j=n.data("cls");t.val("");n.text(i);n.attr("class",j)}function r(n,j,t,i){n.val(t);j.text(i);j.addClass("btn-success");j.append('<span class="close">&times;</span>')}if(!a.data("pickInited")){a.data("pickInited",1);a.data("txt",a.text());a.data("cls",a.attr("class"));a.on("click",".close",k,function(i){var j=jQuery(i.delegateTarget);var n=i.data;l(n,j);n.trigger("change");return false})}if(jQuery.isEmptyObject(o)){l(k,a)}else{for(var b in o){var g=o[b];r(k,a,b,g)}}}else{if(!k.data("pickInited")){k.data("pickInited",1);k.on("click",".close",a,function(i){var n=jQuery(this).closest("li");var t=n.find(":hidden").val();var j=i.data;delete o[t];n.remove();j.show();k.trigger("change");return false});if(!d){k.on("click",null,a,function(i){i.data.click()})}}if(jQuery.isEmptyObject(o)){a.show()}else{if(!d){a.hide()}}k.empty();for(var b in o){var g=o[b];k.append(jQuery('<li class="btn btn-success form-control"></li>').attr("title",g).append(jQuery('<input class="pickval" type="hidden"/>').attr("name",c).val(b)).append(jQuery('<span  class="picktxt"></span>').text(g)).append(jQuery('<span  class="close pull-right">&times;</span>')))}}}function hsListFillPick(b,a,f){var c=b.closest(".pickbox");var e=c.hasClass("pickmul");var d=c.data("pickData")||{};if(!e){c.find(".checkall").hide()}if(!e){HsList.prototype._fill__radio.call(this,b,a,f)}else{HsList.prototype._fill__check.call(this,b,a,f)}if(d[a]!==undefined){b.find(".checkone").prop("checked",true).change()}}(function($){$(document).on("click","[data-toggle=hsPick]",function(){var url=$(this).attr("data-href")||$(this).attr("href");var box=$(this).attr("data-target");if(box){box=$(this)._hsTarget(box)}else{var nav=$(this).closest(".nav");if(nav.size()){var idx=$(this).closest("li").index();box=nav.data("tabs").getPanes().eq(idx)}}var inp=$(this).attr("data-fill-area");if(inp){inp=inp.charAt(0)==">"?$(inp,this):$(inp)}else{inp=$(this).siblings("[name],[data-fn]")}var fun=$(this).attr("data-fill-func");if(fun){fun=eval("("+fun+")")}$(this).hsPick(url,box,inp,fun);return false})})(jQuery);
